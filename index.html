<html>
  <div id="head">
    <head style="text-align: center;">
      <h1> Tabulation </h1>
    </head>
  </div>

  <div id="body">
    <body style="text-align: center;">
      <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
      <button onclick="handleSignInClick()"> Press to sign in to verify access to Google Spreadsheets. </button>
      <br>
      <br>
      <div id='login'>
        <select id="contest-selection">
        </select>
        <br>
        <br>
        <button> Continue </button>
        <br>
        <br>
        <button onclick="function()
        {
          $('#login').hide();
          $('#contest-info').show();
        }"> Create New Contest </button>
      </div>
      <div id='contest-info'>
        <text> Input Contest Name </text>
        <br>
        <input id="contest-name"> </input>
        <br>
        <br>
        <text> Input Division Name </text>
        <br>
        <input id="div-name"> </input>
        <br>
        <br>
        <text> Input Clicker Judges </text>
        <br>
        <textarea id="clicker-judges"></textarea>
        <br>
        <br>
        <text> Input Eval Judges </text>
        <br>
        <textarea id="eval-judges"></textarea>
        <br>
        <br>
        <input id="sheet-link"> Input Spreadsheet Link </input>
        <br>
        <br>
        <button onclick="enterInfo()"> Submit </button>
        <br>
        <br>
      </div>
      <div id='player-info'>
        <text> Input Player List </text>
        <br>
        <textarea id="player-list"></textarea>
        <br>
        <br>
        <button onclick="enterPlayer()"> Submit </button>
      </div>
      <div id='click-input'>
        <text id="click-player-name">  </text>
        <br>
        <br>
        <text> Input Clicker Score </text>
        <br>
        <br>
        <text> Positive </text>
        <br>
        <input id="positive"> </input>
        <br>
        <br>
        <text> Negative </text>
        <br>
        <input id="negative"> </input>
        <br>
        <br>
        <text> Stop </text>
        <br>
        <input id="restart"> </input>
        <br>
        <br>
        <text> Discard </text>
        <br>
        <input id="discard"> </input>
        <br>
        <br>
        <text> Cut </text>
        <br>
        <input id="detach"> </input>
        <br>
        <br>
        <button onclick="storeClick(index)"> Submit </button>
        <br>
        <br>
        <table style="width:100%" id="click-table">
          <tr>
            <td style="width:40%"> Name </td>
            <td style="width:10%"> + </td>
            <td style="width:10%"> - </td>
            <td style="width:10%"> Stop </td>
            <td style="width:10%"> Discard </td>
            <td style="width:10%"> Cut </td>
            <td style="width:10%"> Edit </td>
        </table>
      </div>
      <div id='eval-final-input'>
        <text id="eval-player-name-final">  </text>
        <br>
        <br>
        <text> Input Eval Score </text>
        <br>
        <br>
        <text> Execution </text>
        <br>
        <input id="execution-f"> </input>
        <br>
        <br>
        <text> Control </text>
        <br>
        <input id="control-f"> </input>
        <br>
        <br>
        <text> Variation </text>
        <br>
        <input id="variation-f"> </input>
        <br>
        <br>
        <text> Space Use </text>
        <br>
        <input id="space-use-f"> </input>
        <br>
        <br>
        <text> Choreography </text>
        <br>
        <input id="choreography-f"> </input>
        <br>
        <br>
        <text> Construction </text>
        <br>
        <input id="construction-f"> </input>
        <br>
        <br>
        <text> Body Control </text>
        <br>
        <input id="body-control-f"> </input>
        <br>
        <br>
        <text> Showmanship </text>
        <br>
        <input id="showmanship-f"> </input>
        <br>
        <br>
        <button onclick="storeEval()"> Submit </button>
        <br>
        <br>
        <table style="width:100%" id="eval-final-table">
          <tr>
            <td style="width:20%"> Name </td>
            <td style="width:8%"> EXE </td>
            <td style="width:8%"> CTL </td>
            <td style="width:8%"> TDV </td>
            <td style="width:8%"> SEM </td>
            <td style="width:8%"> MU1 </td>
            <td style="width:8%"> MU2 </td>
            <td style="width:8%"> BDY </td>
            <td style="width:8%"> SHW </td>
            <td style="width:16%"> Edit Scores </td>
        </table>
      </div>
      <div id="finish-click">
        <button onclick="appendClick()"> Submit Final Scores </button>
      </div>
      <div id='eval-qualifying-input'>
        <text id="eval-player-name-qualifying">  </text>
        <br>
        <br>
        <text> Input Eval Score </text>
        <br>
        <br>
        <text> Execution </text>
        <br>
        <input id="execution-q"> </input>
        <br>
        <br>
        <text> Control </text>
        <br>
        <input id="control-q"> </input>
        <br>
        <br>
        <text> Choreography </text>
        <br>
        <input id="choreography-q"> </input>
        <br>
        <br>
        <text> Body Control </text>
        <br>
        <input id="body-control-q"> </input>
        <br>
        <br>
        <button onclick="storeEval()"> Submit </button>
        <br>
        <br>
        <table style="width:100%" id="eval-qualifying-table">
          <tr>
            <td style="width:40%"> Name </td>
            <td style="width:10%"> EXE </td>
            <td style="width:10%"> CTL </td>
            <td style="width:10%"> MU1 </td>
            <td style="width:10%"> BDY </td>
            <td style="width:20%"> Edit Scores </td>
        </table>
      </div>
      <div id="finish-eval">
        <button onclick="appendEval()"> Submit Final Scores </button>
      </div>
      <script src="headJudge.js"> </script>
      <script src="clickerJudge.js"> </script>
      <script src="evalJudge.js"> </script>
      <script src="compile.js"> </script>
    </body>
  </div>

  <script type="text/javascript">
  $(function() {
    $("#login").hide();
    $("#contest-info").hide();
    $("#player-info").hide();
    $("#click-input").hide();
    $("#eval-final-input").hide();
    $("#eval-qualifying-input").hide();
    $("#results-chart").hide();
    $("#texcomp-chart").hide();
    $("#finish-eval").hide();
    $("#finish-click").hide();
    $("#eval-qualifying-table").hide();
    $("#eval-final-table").hide();
  });
  </script>

<script type="text/javascript">
  var spreadsheet = "";
  var contest_name = "";
  var div_name = "";
  var round = "";
  var clicker_judges = [];
  var eval_judges = [];
  var players = [];
  var index = 0;
  var positives = [];
  var negatives = [];
  var restarts = [];
  var discards = [];
  var detaches = [];
  var controlList = [];
  var executionList = [];
  var variationList = [];
  var spaceUseList = [];
  var bodyControlList = [];
  var choreographyList = [];
  var constructionList = [];
  var showmanshipList = [];
  var playerList = [];
  var judgename = "";
  var range = "";
  var techScores = [];
  var techevalScores = [];
  var perfevalScores = [];
  var techeval = 0;
  var perfeval = 0;
  var major = 0;
  var results_order = [];
  var tech_comp = [];
  var oneJ = [];
  var twoJ = [];
  var threeJ = [];
  var fourJ = [];
  var fiveJ = [];
  var sixJ = [];
  var liveClicks  = [];
  var liveEvals = [];
  var judgeType = "";
  var numPlayers = 0;
  var roundType = "";


  function initClient() {
    var API_KEY = "AIzaSyBL78U6X04LeYMJ2h-35dPoPnXduUx_opo";  // TODO: Update placeholder with desired API key.
    var CLIENT_ID = "174011806378-ruu4bj26124mrbejev4btf1v4v8kslrb.apps.googleusercontent.com";  // TODO: Update placeholder with desired client ID.
    var SCOPE = "https://www.googleapis.com/auth/spreadsheets";

    gapi.client.init({
      "apiKey": API_KEY,
      "clientId": CLIENT_ID,
      "scope": SCOPE,
      "discoveryDocs": ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
    }).then(function() {
      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
      updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
    });

  }

  function handleClientLoad() {
  gapi.load("client:auth2", initClient);
  }

  function updateSignInStatus(isSignedIn) {
    if (isSignedIn) {
      $("#login").show();
    }
  }

  function handleSignInClick(event) {
    gapi.auth2.getAuthInstance().signIn();
  }

  function handleSignOutClick(event) {
    gapi.auth2.getAuthInstance().signOut();
  }

  function retrievePlayers() {
    // gets players from spreadsheet
    gapi.client.sheets.spreadsheets.values.get({
    spreadsheetId: spreadsheetId,
    range: "PLAYER!B4:B103"
    }).then((response) => {
    players = response.result.values;
    for (var i=0;i<players.length;i++)
    {
      playerList.push(players[i][0]);
    }
    numPlayers = players.length;
    if (judgeType == "clicker")
    {
    loadClickTable(numPlayers);
    loadClickScores();
    }
    else if (judgeType == "eval")
    {
    loadEvalTable(numPlayers);
    loadEvalScores();
    }
    }, function(reason) {
    console.error("error: " + reason.result.error.message);
    alert("Error.");
    });
  }

  function getJudge() {
    // gets list of judges
    spreadsheet = $('#spreadsheet-id').val();
    var beginId = spreadsheet.indexOf("d/") + 2;
    var endId = spreadsheet.indexOf("/e");
    spreadsheetId = spreadsheet.slice(beginId, endId);
    gapi.client.sheets.spreadsheets.values.get({
    spreadsheetId: spreadsheetId,
    range: "SET-UP!F3:F8"
    }).then((response) => {
    clicker_judges = response.result.values;
    }, function(reason) {
    console.error("error: " + reason.result.error.message);
    alert("Error.");
    });
    gapi.client.sheets.spreadsheets.values.get({
    spreadsheetId: spreadsheetId,
    range: "SET-UP!F16:F21"
    }).then((response) => {
    eval_judges = response.result.values;
    }, function(reason) {
    console.error("error: " + reason.result.error.message);
    alert("Error.");
    });
    console.log(clicker_judges, eval_judges);
  }


</script>

<script async defer src="https://apis.google.com/js/api.js"
onload="this.onload=function(){};handleClientLoad()"
onreadystatechange="if (this.readyState === "complete") this.onload()">
</script>



</html>
